#!/bin/bash

set -e

install-kiosk-browser
install-future-democracy-nodejs

COMMITISH="3b4678a92b077bb8c5cae2ad5d6ad5b076861f01"
REPO_URL="https://github.com/IMAGINARY/future-democracy.git"
INSTALL_DIR="/opt/future-democracy/future-democracy"
NODEJS_BIN_DIR="/opt/future-democracy/nodejs/bin"
export PATH="$NODEJS_BIN_DIR:$PATH"

"${BASH_SOURCE%/*}/../internal/install-source-from-git" "$COMMITISH" "$REPO_URL" "$INSTALL_DIR"

cd "$INSTALL_DIR"
npm install --omit dev

cd "$INSTALL_DIR/server"
npm install --omit dev
