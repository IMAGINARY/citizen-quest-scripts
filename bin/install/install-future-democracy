#!/bin/bash

set -e

install-kiosk-browser
install-future-democracy-nodejs

COMMITISH="v0.5.1"
REPO_URL="https://github.com/IMAGINARY/future-democracy.git"
INSTALL_DIR="/opt/future-democracy/future-democracy"
NODEJS_BIN_DIR="/opt/future-democracy/nodejs/bin"
export PATH="$NODEJS_BIN_DIR:$PATH"

"${BASH_SOURCE%/*}/../internal/install-source-from-git" "$COMMITISH" "$REPO_URL" "$INSTALL_DIR"

cd "$INSTALL_DIR"
npm install --omit dev

cd "$INSTALL_DIR/server"
npm install --omit dev
